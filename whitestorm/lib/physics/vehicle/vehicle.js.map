{"version":3,"sources":["physics/vehicle/vehicle.js"],"names":[],"mappings":"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","file":"vehicle.js","sourcesContent":["import * as THREE from 'three';\r\nimport {VehicleTunning} from './tunning';\r\n\r\nexport class Vehicle {\r\n  constructor(mesh, tuning = new VehicleTuning()) {\r\n    this.mesh = mesh;\r\n    this.wheels = [];\r\n\r\n    this._physijs = {\r\n      id: getObjectId(),\r\n      rigidBody: mesh._physijs.id,\r\n      suspension_stiffness: tuning.suspension_stiffness,\r\n      suspension_compression: tuning.suspension_compression,\r\n      suspension_damping: tuning.suspension_damping,\r\n      max_suspension_travel: tuning.max_suspension_travel,\r\n      friction_slip: tuning.friction_slip,\r\n      max_suspension_force: tuning.max_suspension_force\r\n    };\r\n  }\r\n\r\n  addWheel(wheel_geometry, wheel_material, connection_point, wheel_direction, wheel_axle, suspension_rest_length, wheel_radius, is_front_wheel, tuning) {\r\n    const wheel = new THREE.Mesh(wheel_geometry, wheel_material);\r\n\r\n    wheel.castShadow = wheel.receiveShadow = true;\r\n    wheel.position.copy(wheel_direction).multiplyScalar(suspension_rest_length / 100).add(connection_point);\r\n\r\n    this.world.add(wheel);\r\n    this.wheels.push(wheel);\r\n\r\n    this.world.execute('addWheel', {\r\n      id: this._physijs.id,\r\n      connection_point: {x: connection_point.x, y: connection_point.y, z: connection_point.z},\r\n      wheel_direction: {x: wheel_direction.x, y: wheel_direction.y, z: wheel_direction.z},\r\n      wheel_axle: {x: wheel_axle.x, y: wheel_axle.y, z: wheel_axle.z},\r\n      suspension_rest_length,\r\n      wheel_radius,\r\n      is_front_wheel,\r\n      tuning\r\n    });\r\n  }\r\n\r\n  setSteering(amount, wheel) {\r\n    if (wheel !== undefined && this.wheels[wheel] !== undefined)\r\n      this.world.execute('setSteering', {id: this._physijs.id, wheel, steering: amount});\r\n    else if (this.wheels.length > 0) {\r\n      for (let i = 0; i < this.wheels.length; i++)\r\n        this.world.execute('setSteering', {id: this._physijs.id, wheel: i, steering: amount});\r\n    }\r\n  }\r\n\r\n  setBrake(amount, wheel) {\r\n    if (wheel !== undefined && this.wheels[wheel] !== undefined)\r\n      this.world.execute('setBrake', {id: this._physijs.id, wheel, brake: amount});\r\n    else if (this.wheels.length > 0) {\r\n      for (let i = 0; i < this.wheels.length; i++)\r\n        this.world.execute('setBrake', {id: this._physijs.id, wheel: i, brake: amount});\r\n    }\r\n  }\r\n\r\n  applyEngineForce(amount, wheel) {\r\n    if (wheel !== undefined && this.wheels[wheel] !== undefined)\r\n      this.world.execute('applyEngineForce', {id: this._physijs.id, wheel, force: amount});\r\n    else if (this.wheels.length > 0) {\r\n      for (let i = 0; i < this.wheels.length; i++)\r\n        this.world.execute('applyEngineForce', {id: this._physijs.id, wheel: i, force: amount});\r\n    }\r\n  }\r\n}\r\n"]}